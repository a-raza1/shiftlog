<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>History</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f2f2f7; font-family: -apple-system, sans-serif; }
        .list-group-item { border: none; margin-bottom: 2px; border-radius: 0px; background: #fff; }
        .list-group-item:first-child { border-top-left-radius: 15px !important; border-top-right-radius: 15px !important; }
        .list-group-item:last-child { border-bottom-left-radius: 15px !important; border-bottom-right-radius: 15px !important; margin-bottom: 25px; }
        
        .grand-total-card { background: #000; color: #fff; border-radius: 20px; padding: 25px; margin-bottom: 30px; }
        .week-header { font-weight: 700; font-size: 0.85rem; color: #8e8e93; text-transform: uppercase; margin-bottom: 8px; padding-left: 5px; display: flex; justify-content: space-between; }
        .week-total-label { color: #007aff; }
        
        .employer-name { font-weight: 600; font-size: 1rem; color: #000; }
        .shift-date { color: #8e8e93; font-size: 0.85rem; display: flex; align-items: center; flex-wrap: wrap; gap: 5px; }
        .hours-pill { font-weight: 700; font-size: 1rem; color: #1c1c1e; }
        
        /* Break Badge Style */
        .break-tag {
            background: #fff5f5;
            color: #ff3b30; 
            font-size: 0.72rem;
            padding: 2px 8px;
            border-radius: 6px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            border: 1px solid rgba(255, 59, 48, 0.1);
        }
    </style>
</head>
<body>
<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <a href="/{{ secret }}" class="text-decoration-none fw-bold" style="color: #007aff;">← Log</a>
        <h2 class="fw-bold m-0">History</h2>
        <a href="/{{ secret }}/admin" class="text-muted small text-decoration-none">Edit</a>
    </div>

    <div class="grand-total-card text-center shadow-sm">
        <span class="text-uppercase small fw-bold" style="opacity: 0.6; letter-spacing: 1px;">Monthly Grand Total</span>
        <h2 class="display-5 fw-bold m-0">{{ "%.2f"|format(grand_total) }} <small style="font-size: 1.2rem; opacity: 0.8;">hrs</small></h2>
    </div>
    <div class="d-flex overflow-auto pb-3 mb-3" style="gap: 10px; -webkit-overflow-scrolling: touch;">
    {% for m in available_months %}
    <a href="/{{ secret }}/view?month={{ m.num }}&year={{ current_year }}" 
       class="btn btn-sm px-3 rounded-pill {% if m.num == current_month %}btn-primary{% else %}btn-light{% endif %}"
       style="white-space: nowrap; font-weight: 600;">
        {{ m.name }}
    </a>
    {% endfor %}
</div>

<div class="text-center mb-4">
    <span class="badge bg-light text-dark border rounded-pill">{{ current_year }}</span>
</div>
    {% for week in weeks %}
    <div class="week-header">
        <span>Week {{ week.days[0].date.strftime('%W') }}</span>
        <span class="week-total-label">Weekly Total: {{ "%.2f"|format(week.total) }}h</span>
    </div>
    <div class="list-group mb-4 shadow-sm">
        {% for day in week.days %}
        <div class="list-group-item d-flex justify-content-between align-items-center p-3">
            <div style="flex: 1;">
                <div class="employer-name">{{ day.employer }}</div>
                <div class="shift-date">
                    {{ day.date.strftime('%a, %b %d') }} • {{ day.start_time }}-{{ day.end_time }}
                    {% if day.break_minutes > 0 %}
                    <span class="break-tag">
                        <svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" fill="currentColor" viewBox="0 0 16 16">
                          <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.25 5C5.56 5 5 5.56 5 6.25v3.5a1.25 1.25 0 1 0 2.5 0v-3.5C7.5 5.56 6.94 5 6.25 5m7.5 0c-.69 0-1.25.56-1.25 1.25v3.5a1.25 1.25 0 1 0 2.5 0v-3.5C15 5.56 14.44 5 13.75 5"/>
                        </svg>
                        {{ day.break_minutes }}m break
                    </span>
                    {% endif %}
                </div>
            </div>
            <div class="hours-pill text-end">
                {{ "%.2f"|format(day.total_hours) }} <span style="font-size: 0.75rem; color: #8e8e93; font-weight: 400;">hrs</span>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center mt-5 py-5">
        <p class="text-muted">No shifts logged yet.</p>
        <a href="/" class="btn btn-primary rounded-pill px-4">Log your first shift</a>
    </div>
    {% endfor %}
</div>
</body>
</html>